/*
 localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/
!function(d){"object"==typeof exports&&"undefined"!=typeof module?module.exports=d():"function"==typeof define&&define.amd?define([],d):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).localforage=d()}(function(){return function w(f,n,q){function r(y,B){if(!n[y]){if(!f[y]){var J="function"==typeof require&&require;if(!B&&J)return J(y,!0);if(z)return z(y,!0);B=Error("Cannot find module '"+y+"'");throw B.code="MODULE_NOT_FOUND",B;}B=n[y]={exports:{}};
f[y][0].call(B.exports,function(E){return r(f[y][1][E]||E)},B,B.exports,w,f,n,q)}return n[y].exports}for(var z="function"==typeof require&&require,x=0;x<q.length;x++)r(q[x]);return r}({1:[function(f,n,q){function w(a,b){a=a||[];b=b||{};try{return new Blob(a,b)}catch(h){if("TypeError"!==h.name)throw h;for(var c=new ("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),e=0;e<a.length;e+=1)c.append(a[e]);
return c.getBlob(b.type)}}function r(a,b){b&&a.then(function(c){b(null,c)},function(c){b(c)})}function z(a,b,c){"function"==typeof b&&a.then(b);"function"==typeof c&&a.catch(c)}function x(a){return"string"!=typeof a&&(console.warn(a+" used as a key, but it is not a string."),a=String(a)),a}function y(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}function B(a){return(new u(function(b){var c=a.transaction(X,U),e=w([""]);c.objectStore(X).put(e,
"key");c.onabort=function(h){h.preventDefault();h.stopPropagation();b(!1)};c.oncomplete=function(){var h=navigator.userAgent.match(/Chrome\/(\d+)/),g=navigator.userAgent.match(/Edge\//);b(g||!h||43<=parseInt(h[1],10))}})).catch(function(){return!1})}function J(a){return"boolean"==typeof Y?u.resolve(Y):B(a).then(function(b){return Y=b})}function E(a){a=C[a.name];var b={};b.promise=new u(function(c,e){b.resolve=c;b.reject=e});a.deferredOperations.push(b);a.dbReady?a.dbReady=a.dbReady.then(function(){return b.promise}):
a.dbReady=b.promise}function K(a){if(a=C[a.name].deferredOperations.pop())return a.resolve(),a.promise}function L(a,b){if(a=C[a.name].deferredOperations.pop())return a.reject(b),a.promise}function N(a,b){return new u(function(c,e){if(C[a.name]=C[a.name]||fa(),a.db){if(!b)return c(a.db);E(a);a.db.close()}var h=[a.name];b&&h.push(a.version);var g=O.open.apply(O,h);b&&(g.onupgradeneeded=function(k){var m=g.result;try{m.createObjectStore(a.storeName),1>=k.oldVersion&&m.createObjectStore(X)}catch(l){if("ConstraintError"!==
l.name)throw l;console.warn('The database "'+a.name+'" has been upgraded from version '+k.oldVersion+" to version "+k.newVersion+', but the storage "'+a.storeName+'" already exists.')}});g.onerror=function(k){k.preventDefault();e(g.error)};g.onsuccess=function(){var k=g.result;k.onversionchange=function(m){m.target.close()};c(k);K(a)}})}function G(a,b){if(!a.db)return!0;var c=!a.db.objectStoreNames.contains(a.storeName),e=a.version>a.db.version;return(a.version<a.db.version&&(a.version!==b&&console.warn('The database "'+
a.name+"\" can't be downgraded from version "+a.db.version+" to version "+a.version+"."),a.version=a.db.version),e||c)?(c&&(b=a.db.version+1,b>a.version&&(a.version=b)),!0):!1}function R(a){return new u(function(b,c){var e=new FileReader;e.onerror=c;e.onloadend=function(h){h=btoa(h.target.result||"");b({__local_forage_encoded_blob:!0,data:h,type:a.type})};e.readAsBinaryString(a)})}function S(a){for(var b=atob(a.data),c=b.length,e=new ArrayBuffer(c),h=new Uint8Array(e),g=0;g<c;g++)h[g]=b.charCodeAt(g);
return w([e],{type:a.type})}function qa(a){var b=this,c=b._initReady().then(function(){var e=C[b._dbInfo.name];if(e&&e.dbReady)return e.dbReady});return z(c,a,a),c}function ra(a){E(a);for(var b=C[a.name],c=b.forages,e=0;e<c.length;e++){var h=c[e];h._dbInfo.db&&(h._dbInfo.db.close(),h._dbInfo.db=null)}return a.db=null,N(a,!1).then(function(g){return a.db=g,G(a)?N(a,!0):g}).then(function(g){a.db=b.db=g;for(var k=0;k<c.length;k++)c[k]._dbInfo.db=g}).catch(function(g){throw L(a,g),g;})}function F(a,b,
c,e){void 0===e&&(e=1);try{var h=a.db.transaction(a.storeName,b);c(null,h)}catch(g){if(0<e&&(!a.db||"InvalidStateError"===g.name||"NotFoundError"===g.name))return u.resolve().then(function(){if(!a.db||"NotFoundError"===g.name&&!a.db.objectStoreNames.contains(a.storeName)&&a.version<=a.db.version)return a.db&&(a.version=a.db.version+1),N(a,!0)}).then(function(){return ra(a).then(function(){F(a,b,c,e-1)})}).catch(c);c(g)}}function fa(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function ha(a){var b=
.75*a.length;var c=a.length,e=0;"="===a[a.length-1]&&(b--,"="===a[a.length-2]&&b--);var h=new ArrayBuffer(b),g=new Uint8Array(h);for(b=0;b<c;b+=4){var k=H.indexOf(a[b]);var m=H.indexOf(a[b+1]);var l=H.indexOf(a[b+2]);var p=H.indexOf(a[b+3]);g[e++]=k<<2|m>>4;g[e++]=(15&m)<<4|l>>2;g[e++]=(3&l)<<6|63&p}return h}function Z(a){var b=new Uint8Array(a),c="";for(a=0;a<b.length;a+=3)c+=H[b[a]>>2],c+=H[(3&b[a])<<4|b[a+1]>>4],c+=H[(15&b[a+1])<<2|b[a+2]>>6],c+=H[63&b[a+2]];return 2==b.length%3?c=c.substring(0,
c.length-1)+"=":1==b.length%3&&(c=c.substring(0,c.length-2)+"=="),c}function ia(a,b,c,e){a.executeSql("CREATE TABLE IF NOT EXISTS "+b.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],c,e)}function I(a,b,c,e,h,g){a.executeSql(c,e,h,function(k,m){m.code===m.SYNTAX_ERR?k.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[b.storeName],function(l,p){p.rows.length?g(l,m):ia(l,b,function(){l.executeSql(c,e,h,g)},g)},g):g(k,m)},g)}function ja(a,b,c,e){var h=this;a=x(a);
var g=new u(function(k,m){h.ready().then(function(){void 0===b&&(b=null);var l=b,p=h._dbInfo;p.serializer.serialize(b,function(t,v){v?m(v):p.db.transaction(function(A){I(A,p,"INSERT OR REPLACE INTO "+p.storeName+" (key, value) VALUES (?, ?)",[a,t],function(){k(l)},function(D,M){m(M)})},function(A){if(A.code===A.QUOTA_ERR){if(0<e)return void k(ja.apply(h,[a,l,c,e-1]));m(A)}})})}).catch(m)});return r(g,c),g}function sa(a){return new u(function(b,c){a.transaction(function(e){e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",
[],function(h,g){h=[];for(var k=0;k<g.rows.length;k++)h.push(g.rows.item(k).name);b({db:a,storeNames:h})},function(h,g){c(g)})},function(e){c(e)})})}function ka(a,b){var c=a.name+"/";return a.storeName!==b.storeName&&(c+=a.storeName+"/"),c}function ta(a,b){a[b]=function(){var c=arguments;return a.ready().then(function(){return a[b].apply(a,c)})}}function aa(){for(var a=1;a<arguments.length;a++){var b=arguments[a];if(b)for(var c in b)b.hasOwnProperty(c)&&(la(b[c])?arguments[0][c]=b[c].slice():arguments[0][c]=
b[c])}return arguments[0]}var ua="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},O=function(){if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}();
"undefined"==typeof Promise&&f("lie/polyfill");var u=Promise,X="local-forage-detect-blob-support",Y=void 0,C={},va=Object.prototype.toString,U="readwrite";f={_driver:"asyncStorage",_initStorage:function(a){function b(){return u.resolve()}var c=this,e={db:null};if(a)for(var h in a)e[h]=a[h];var g=C[e.name];g||(g=fa(),C[e.name]=g);g.forages.push(c);c._initReady||(c._initReady=c.ready,c.ready=qa);a=[];for(h=0;h<g.forages.length;h++){var k=g.forages[h];k!==c&&a.push(k._initReady().catch(b))}var m=g.forages.slice(0);
return u.all(a).then(function(){return e.db=g.db,N(e,!1)}).then(function(l){return e.db=l,G(e,c._defaultConfig.version)?N(e,!0):l}).then(function(l){e.db=g.db=l;c._dbInfo=e;for(l=0;l<m.length;l++){var p=m[l];p!==c&&(p._dbInfo.db=e.db,p._dbInfo.version=e.version)}})},_support:function(){try{if(!O||!O.open)return!1;var a="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),b="function"==typeof fetch&&
-1!==fetch.toString().indexOf("[native code");return(!a||b)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(c){return!1}}(),iterate:function(a,b){var c=this,e=new u(function(h,g){c.ready().then(function(){F(c._dbInfo,"readonly",function(k,m){if(k)return g(k);try{var l=m.objectStore(c._dbInfo.storeName).openCursor(),p=1;l.onsuccess=function(){var t=l.result;if(t){var v=t.value;v&&v.__local_forage_encoded_blob&&(v=S(v));v=a(v,t.key,p++);void 0!==v?h(v):t.continue()}else h()};l.onerror=
function(){g(l.error)}}catch(t){g(t)}})}).catch(g)});return r(e,b),e},getItem:function(a,b){var c=this;a=x(a);var e=new u(function(h,g){c.ready().then(function(){F(c._dbInfo,"readonly",function(k,m){if(k)return g(k);try{var l=m.objectStore(c._dbInfo.storeName).get(a);l.onsuccess=function(){var p=l.result;void 0===p&&(p=null);p&&p.__local_forage_encoded_blob&&(p=S(p));h(p)};l.onerror=function(){g(l.error)}}catch(p){g(p)}})}).catch(g)});return r(e,b),e},setItem:function(a,b,c){var e=this;a=x(a);var h=
new u(function(g,k){var m;e.ready().then(function(){return m=e._dbInfo,"[object Blob]"===va.call(b)?J(m.db).then(function(l){return l?b:R(b)}):b}).then(function(l){F(e._dbInfo,U,function(p,t){if(p)return k(p);try{var v=t.objectStore(e._dbInfo.storeName);null===l&&(l=void 0);var A=v.put(l,a);t.oncomplete=function(){void 0===l&&(l=null);g(l)};t.onabort=t.onerror=function(){k(A.error?A.error:A.transaction.error)}}catch(D){k(D)}})}).catch(k)});return r(h,c),h},removeItem:function(a,b){var c=this;a=x(a);
var e=new u(function(h,g){c.ready().then(function(){F(c._dbInfo,U,function(k,m){if(k)return g(k);try{var l=m.objectStore(c._dbInfo.storeName).delete(a);m.oncomplete=function(){h()};m.onerror=function(){g(l.error)};m.onabort=function(){g(l.error?l.error:l.transaction.error)}}catch(p){g(p)}})}).catch(g)});return r(e,b),e},clear:function(a){var b=this,c=new u(function(e,h){b.ready().then(function(){F(b._dbInfo,U,function(g,k){if(g)return h(g);try{var m=k.objectStore(b._dbInfo.storeName).clear();k.oncomplete=
function(){e()};k.onabort=k.onerror=function(){h(m.error?m.error:m.transaction.error)}}catch(l){h(l)}})}).catch(h)});return r(c,a),c},length:function(a){var b=this,c=new u(function(e,h){b.ready().then(function(){F(b._dbInfo,"readonly",function(g,k){if(g)return h(g);try{var m=k.objectStore(b._dbInfo.storeName).count();m.onsuccess=function(){e(m.result)};m.onerror=function(){h(m.error)}}catch(l){h(l)}})}).catch(h)});return r(c,a),c},key:function(a,b){var c=this,e=new u(function(h,g){if(0>a)return void h(null);
c.ready().then(function(){F(c._dbInfo,"readonly",function(k,m){if(k)return g(k);try{var l=!1,p=m.objectStore(c._dbInfo.storeName).openKeyCursor();p.onsuccess=function(){var t=p.result;if(!t)return void h(null);0===a?h(t.key):l?h(t.key):(l=!0,t.advance(a))};p.onerror=function(){g(p.error)}}catch(t){g(t)}})}).catch(g)});return r(e,b),e},keys:function(a){var b=this,c=new u(function(e,h){b.ready().then(function(){F(b._dbInfo,"readonly",function(g,k){if(g)return h(g);try{var m=k.objectStore(b._dbInfo.storeName).openKeyCursor(),
l=[];m.onsuccess=function(){var p=m.result;if(!p)return void e(l);l.push(p.key);p.continue()};m.onerror=function(){h(m.error)}}catch(p){h(p)}})}).catch(h)});return r(c,a),c},dropInstance:function(a,b){b=y.apply(this,arguments);var c=this.config();a="function"!=typeof a&&a||{};a.name||(a.name=a.name||c.name,a.storeName=a.storeName||c.storeName);a.name?(c=a.name===c.name&&this._dbInfo.db?u.resolve(this._dbInfo.db):N(a,!1).then(function(e){var h=C[a.name],g=h.forages;h.db=e;for(h=0;h<g.length;h++)g[h]._dbInfo.db=
e;return e}),c=a.storeName?c.then(function(e){if(e.objectStoreNames.contains(a.storeName)){var h=e.version+1;E(a);var g=C[a.name],k=g.forages;e.close();for(e=0;e<k.length;e++){var m=k[e];m._dbInfo.db=null;m._dbInfo.version=h}return(new u(function(l,p){var t=O.open(a.name,h);t.onerror=function(v){t.result.close();p(v)};t.onupgradeneeded=function(){t.result.deleteObjectStore(a.storeName)};t.onsuccess=function(){var v=t.result;v.close();l(v)}})).then(function(l){g.db=l;for(var p=0;p<k.length;p++){var t=
k[p];t._dbInfo.db=l;K(t._dbInfo)}}).catch(function(l){throw(L(a,l)||u.resolve()).catch(function(){}),l;})}}):c.then(function(e){E(a);var h=C[a.name],g=h.forages;e.close();for(e=0;e<g.length;e++)g[e]._dbInfo.db=null;return(new u(function(k,m){var l=O.deleteDatabase(a.name);l.onerror=function(){var p=l.result;p&&p.close();m(l.error)};l.onblocked=function(){console.warn('dropInstance blocked for database "'+a.name+'" until all open connections are closed')};l.onsuccess=function(){var p=l.result;p&&p.close();
k(p)}})).then(function(k){h.db=k;for(k=0;k<g.length;k++)K(g[k]._dbInfo)}).catch(function(k){throw(L(a,k)||u.resolve()).catch(function(){}),k;})})):c=u.reject("Invalid arguments");return r(c,b),c}};var H="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ma=/^~~local_forage_type~([^~]+)~/,na=Object.prototype.toString,ba={serialize:function(a,b){var c="";if(a&&(c=na.call(a)),a&&("[object ArrayBuffer]"===c||a.buffer&&"[object ArrayBuffer]"===na.call(a.buffer))){var e,h="__lfsc__:";a instanceof
ArrayBuffer?(e=a,h+="arbf"):(e=a.buffer,"[object Int8Array]"===c?h+="si08":"[object Uint8Array]"===c?h+="ui08":"[object Uint8ClampedArray]"===c?h+="uic8":"[object Int16Array]"===c?h+="si16":"[object Uint16Array]"===c?h+="ur16":"[object Int32Array]"===c?h+="si32":"[object Uint32Array]"===c?h+="ui32":"[object Float32Array]"===c?h+="fl32":"[object Float64Array]"===c?h+="fl64":b(Error("Failed to get type for BinaryArray")));b(h+Z(e))}else if("[object Blob]"===c)c=new FileReader,c.onload=function(){var g=
"~~local_forage_type~"+a.type+"~"+Z(this.result);b("__lfsc__:blob"+g)},c.readAsArrayBuffer(a);else try{b(JSON.stringify(a))}catch(g){console.error("Couldn't convert value into a JSON string: ",a),b(null,g)}},deserialize:function(a){if("__lfsc__:"!==a.substring(0,9))return JSON.parse(a);var b=a.substring(13);a=a.substring(9,13);if("blob"===a&&ma.test(b)){var c=b.match(ma);var e=c[1];b=b.substring(c[0].length)}b=ha(b);switch(a){case "arbf":return b;case "blob":return w([b],{type:e});case "si08":return new Int8Array(b);
case "ui08":return new Uint8Array(b);case "uic8":return new Uint8ClampedArray(b);case "si16":return new Int16Array(b);case "ur16":return new Uint16Array(b);case "si32":return new Int32Array(b);case "ui32":return new Uint32Array(b);case "fl32":return new Float32Array(b);case "fl64":return new Float64Array(b);default:throw Error("Unkown type: "+a);}},stringToBuffer:ha,bufferToString:Z};q={_driver:"webSQLStorage",_initStorage:function(a){var b=this,c={db:null};if(a)for(var e in a)c[e]="string"!=typeof a[e]?
a[e].toString():a[e];a=new u(function(h,g){try{c.db=openDatabase(c.name,String(c.version),c.description,c.size)}catch(k){return g(k)}c.db.transaction(function(k){ia(k,c,function(){b._dbInfo=c;h()},function(m,l){g(l)})},g)});return c.serializer=ba,a},_support:"function"==typeof openDatabase,iterate:function(a,b){var c=this,e=new u(function(h,g){c.ready().then(function(){var k=c._dbInfo;k.db.transaction(function(m){I(m,k,"SELECT * FROM "+k.storeName,[],function(l,p){l=p.rows;p=l.length;for(var t=0;t<
p;t++){var v=l.item(t),A=v.value;if(A&&=k.serializer.deserialize(A),void 0!==(A=a(A,v.key,t+1)))return void h(A)}h()},function(l,p){g(p)})})}).catch(g)});return r(e,b),e},getItem:function(a,b){var c=this;a=x(a);var e=new u(function(h,g){c.ready().then(function(){var k=c._dbInfo;k.db.transaction(function(m){I(m,k,"SELECT * FROM "+k.storeName+" WHERE key = ? LIMIT 1",[a],function(l,p){(l=p.rows.length?p.rows.item(0).value:null)&&(l=k.serializer.deserialize(l));h(l)},function(l,p){g(p)})})}).catch(g)});
return r(e,b),e},setItem:function(a,b,c){return ja.apply(this,[a,b,c,1])},removeItem:function(a,b){var c=this;a=x(a);var e=new u(function(h,g){c.ready().then(function(){var k=c._dbInfo;k.db.transaction(function(m){I(m,k,"DELETE FROM "+k.storeName+" WHERE key = ?",[a],function(){h()},function(l,p){g(p)})})}).catch(g)});return r(e,b),e},clear:function(a){var b=this,c=new u(function(e,h){b.ready().then(function(){var g=b._dbInfo;g.db.transaction(function(k){I(k,g,"DELETE FROM "+g.storeName,[],function(){e()},
function(m,l){h(l)})})}).catch(h)});return r(c,a),c},length:function(a){var b=this,c=new u(function(e,h){b.ready().then(function(){var g=b._dbInfo;g.db.transaction(function(k){I(k,g,"SELECT COUNT(key) as c FROM "+g.storeName,[],function(m,l){m=l.rows.item(0).c;e(m)},function(m,l){h(l)})})}).catch(h)});return r(c,a),c},key:function(a,b){var c=this,e=new u(function(h,g){c.ready().then(function(){var k=c._dbInfo;k.db.transaction(function(m){I(m,k,"SELECT key FROM "+k.storeName+" WHERE id = ? LIMIT 1",
[a+1],function(l,p){l=p.rows.length?p.rows.item(0).key:null;h(l)},function(l,p){g(p)})})}).catch(g)});return r(e,b),e},keys:function(a){var b=this,c=new u(function(e,h){b.ready().then(function(){var g=b._dbInfo;g.db.transaction(function(k){I(k,g,"SELECT key FROM "+g.storeName,[],function(m,l){m=[];for(var p=0;p<l.rows.length;p++)m.push(l.rows.item(p).key);e(m)},function(m,l){h(l)})})}).catch(h)});return r(c,a),c},dropInstance:function(a,b){b=y.apply(this,arguments);var c=this.config();a="function"!=
typeof a&&a||{};a.name||(a.name=a.name||c.name,a.storeName=a.storeName||c.storeName);var e,h=this;return e=a.name?(new u(function(g){var k=a.name===c.name?h._dbInfo.db:openDatabase(a.name,"","",0);g(a.storeName?{db:k,storeNames:[a.storeName]}:sa(k))})).then(function(g){return new u(function(k,m){g.db.transaction(function(l){function p(D){return new u(function(M,ca){l.executeSql("DROP TABLE IF EXISTS "+D,[],function(){M()},function(V,da){ca(da)})})}for(var t=[],v=0,A=g.storeNames.length;v<A;v++)t.push(p(g.storeNames[v]));
u.all(t).then(function(){k()}).catch(function(D){m(D)})},function(l){m(l)})})}):u.reject("Invalid arguments"),r(e,b),e}};try{var P="undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(a){P=!1}var wa=function(a,b){for(var c=a.length,e=0;e<c;){var h=a[e],g=b;if(h===g||"number"==typeof h&&"number"==typeof g&&isNaN(h)&&isNaN(g))return!0;e++}return!1},la=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},T={},oa={},Q={INDEXEDDB:f,
WEBSQL:q,LOCALSTORAGE:{_driver:"localStorageWrapper",_initStorage:function(a){var b={};if(a)for(var c in a)b[c]=a[c];b.keyPrefix=ka(a,this._defaultConfig);try{var e=(localStorage.setItem("_localforage_support_test",!0),localStorage.removeItem("_localforage_support_test"),!1)}catch(h){e=!0}return!e||0<localStorage.length?(this._dbInfo=b,b.serializer=ba,u.resolve()):u.reject()},_support:P,iterate:function(a,b){var c=this,e=c.ready().then(function(){for(var h=c._dbInfo,g=h.keyPrefix,k=g.length,m=localStorage.length,
l=1,p=0;p<m;p++){var t=localStorage.key(p);if(0===t.indexOf(g)){var v=localStorage.getItem(t);if(v&&=h.serializer.deserialize(v),void 0!==(v=a(v,t.substring(k),l++)))return v}}});return r(e,b),e},getItem:function(a,b){var c=this;a=x(a);var e=c.ready().then(function(){var h=c._dbInfo,g=localStorage.getItem(h.keyPrefix+a);return g&&=h.serializer.deserialize(g),g});return r(e,b),e},setItem:function(a,b,c){var e=this;a=x(a);var h=e.ready().then(function(){void 0===b&&(b=null);var g=b;return new u(function(k,
m){var l=e._dbInfo;l.serializer.serialize(b,function(p,t){if(t)m(t);else try{localStorage.setItem(l.keyPrefix+a,p),k(g)}catch(v){"QuotaExceededError"!==v.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==v.name||m(v),m(v)}})})});return r(h,c),h},removeItem:function(a,b){var c=this;a=x(a);var e=c.ready().then(function(){localStorage.removeItem(c._dbInfo.keyPrefix+a)});return r(e,b),e},clear:function(a){var b=this,c=b.ready().then(function(){for(var e=b._dbInfo.keyPrefix,h=localStorage.length-1;0<=h;h--){var g=
localStorage.key(h);0===g.indexOf(e)&&localStorage.removeItem(g)}});return r(c,a),c},length:function(a){var b=this.keys().then(function(c){return c.length});return r(b,a),b},key:function(a,b){var c=this,e=c.ready().then(function(){var h=c._dbInfo;try{var g=localStorage.key(a)}catch(k){g=null}return g&&=g.substring(h.keyPrefix.length),g});return r(e,b),e},keys:function(a){var b=this,c=b.ready().then(function(){for(var e=b._dbInfo,h=localStorage.length,g=[],k=0;k<h;k++){var m=localStorage.key(k);0===
m.indexOf(e.keyPrefix)&&g.push(m.substring(e.keyPrefix.length))}return g});return r(c,a),c},dropInstance:function(a,b){if(b=y.apply(this,arguments),a="function"!=typeof a&&a||{},!a.name){var c=this.config();a.name=a.name||c.name;a.storeName=a.storeName||c.storeName}var e,h=this;return e=a.name?(new u(function(g){g(a.storeName?ka(a,h._defaultConfig):a.name+"/")})).then(function(g){for(var k=localStorage.length-1;0<=k;k--){var m=localStorage.key(k);0===m.indexOf(g)&&localStorage.removeItem(m)}}):u.reject("Invalid arguments"),
r(e,b),e}}};P=[Q.INDEXEDDB._driver,Q.WEBSQL._driver,Q.LOCALSTORAGE._driver];var W=["dropInstance"],ea="clear getItem iterate key keys length removeItem setItem".split(" ").concat(W),xa={description:"",driver:P.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};P=new (function(){function a(b){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");for(var c in Q)if(Q.hasOwnProperty(c)){var e=Q[c],h=e._driver;this[c]=h;T[h]||this.defineDriver(e)}this._defaultConfig=
aa({},xa);this._config=aa({},this._defaultConfig,b);this._initDriver=this._driverSet=null;this._ready=!1;this._dbInfo=null;this._wrapLibraryMethodsWithReady();this.setDriver(this._config.driver).catch(function(){})}return a.prototype.config=function(b){if("object"===(void 0===b?"undefined":ua(b))){if(this._ready)return Error("Can't call config() after localforage has been used.");for(var c in b){if("storeName"===c&&(b[c]=b[c].replace(/\W/g,"_")),"version"===c&&"number"!=typeof b[c])return Error("Database version must be a number.");
this._config[c]=b[c]}return!("driver"in b&&b.driver)||this.setDriver(this._config.driver)}return"string"==typeof b?this._config[b]:this._config},a.prototype.defineDriver=function(b,c,e){var h=new u(function(g,k){try{var m=b._driver,l=Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!b._driver)return void k(l);for(var p=ea.concat("_initStorage"),t=0,v=p.length;t<v;t++){var A=p[t];if((!wa(W,A)||b[A])&&"function"!=typeof b[A])return void k(l)}(function(){for(var D=
function(da){return function(){var pa=u.reject(Error("Method "+da+" is not implemented by the current driver"));return r(pa,arguments[arguments.length-1]),pa}},M=0,ca=W.length;M<ca;M++){var V=W[M];b[V]||(b[V]=D(V))}})();l=function(D){T[m]&&console.info("Redefining LocalForage driver: "+m);T[m]=b;oa[m]=D;g()};"_support"in b?b._support&&"function"==typeof b._support?b._support().then(l,k):l(!!b._support):l(!0)}catch(D){k(D)}});return z(h,c,e),h},a.prototype.driver=function(){return this._driver||null},
a.prototype.getDriver=function(b,c,e){b=T[b]?u.resolve(T[b]):u.reject(Error("Driver not found."));return z(b,c,e),b},a.prototype.getSerializer=function(b){var c=u.resolve(ba);return z(c,b),c},a.prototype.ready=function(b){var c=this,e=c._driverSet.then(function(){return null===c._ready&&(c._ready=c._initDriver()),c._ready});return z(e,b,b),e},a.prototype.setDriver=function(b,c,e){function h(){m._config.driver=m.driver()}function g(p){return m._extend(p),h(),m._ready=m._initStorage(m._config),m._ready}
function k(p){return function(){function t(){for(;v<p.length;){var A=p[v];return v++,m._dbInfo=null,m._ready=null,m.getDriver(A).then(g).catch(t)}h();return m._driverSet=u.reject(Error("No available storage method found.")),m._driverSet}var v=0;return t()}}var m=this;la(b)||(b=[b]);var l=this._getSupportedDrivers(b);return this._driverSet=(null!==this._driverSet?this._driverSet.catch(function(){return u.resolve()}):u.resolve()).then(function(){var p=l[0];return m._dbInfo=null,m._ready=null,m.getDriver(p).then(function(t){m._driver=
t._driver;h();m._wrapLibraryMethodsWithReady();m._initDriver=k(l)})}).catch(function(){h();return m._driverSet=u.reject(Error("No available storage method found.")),m._driverSet}),z(this._driverSet,c,e),this._driverSet},a.prototype.supports=function(b){return!!oa[b]},a.prototype._extend=function(b){aa(this,b)},a.prototype._getSupportedDrivers=function(b){for(var c=[],e=0,h=b.length;e<h;e++){var g=b[e];this.supports(g)&&c.push(g)}return c},a.prototype._wrapLibraryMethodsWithReady=function(){for(var b=
0,c=ea.length;b<c;b++)ta(this,ea[b])},a.prototype.createInstance=function(b){return new a(b)},a}());n.exports=P},{undefined:void 0}]},{},[1])(1)});/*
 loadCSS. [c]2020 Filament Group, Inc. MIT License  Minifed  onloadCSS. (onload callback for loadCSS) [c]2017 Filament Group, Inc. MIT License */
!function(d){var f=function(n,q,w,r){function z(){y.addEventListener&&y.removeEventListener("load",z);y.media=w||"all"}var x=d.document,y=x.createElement("link");if(q)var B=q;else{var J=(x.body||x.getElementsByTagName("head")[0]).childNodes;B=J[J.length-1]}var E=x.styleSheets;if(r)for(var K in r)r.hasOwnProperty(K)&&y.setAttribute(K,r[K]);y.rel="stylesheet";y.href=n;y.media="only x";!function R(G){if(x.body)return G();setTimeout(function(){R(G)})}(function(){B.parentNode.insertBefore(y,q?B:B.nextSibling)});
var L=function(G){for(var R=y.href,S=E.length;S--;)if(E[S].href===R)return G();setTimeout(function(){L(G)})};return y.addEventListener&&y.addEventListener("load",z),y.onloadcssdefined=L,L(z),y};"undefined"!=typeof exports?exports.loadCSS=f:d.loadCSS=f}("undefined"!=typeof global?global:this);
function onloadCSS(d,f){function n(){!q&&f&&(q=!0,f.call(d))}var q;d.addEventListener&&d.addEventListener("load",n);d.attachEvent&&d.attachEvent("onload",n);"isApplicationInstalled"in navigator&&"onloadcssdefined"in d&&d.onloadcssdefined(n)}onloadCSS(loadCSS("https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0&display=block"),function(){document.body.classList.add("materialSymbolsLoaded");loaded()});onloadCSS(loadCSS("./main.css"),function(){loaded()});
document.querySelectorAll("[id]").forEach(function(d){window[d.id]=d});
var hints={schName:"Give this schedule a name. For example: 'Regular Schedule', 'Late Start', 'Block A', etc.",schPeriods:"Add some periods. Ex. class periods, passing periods, lunch, and anything else you want to add.",schPeriodName:"Name of period, ex. First period, 1st-2nd passing period, Lunch, etc.",schPeriodStart:"Start of period, ex. 9:00 AM",schPeriodEnd:"End of period, ex. 10:00 AM",schDays:"Which days of the week is this schedule effective? For example, all weekdays, only Monday, etc.",periodMoveUp:"Move this period up",
periodRemove:"Remove this period",periodMoveDown:"Move this period down"},lastUsedScheduleId=1,lastUsedPeriodIds=[],daysBitmap={sunday:1,monday:2,tuesday:4,wednesday:8,thursday:16,friday:32,saturday:64},timeToCharacter="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-".split(""),usingURL=!1,lastSavedSchedules=null,darkishBgs=["dark"],lightishBgs=["light","mistyRose"],defaultSettings={themeBg:"dark",themeFg:"darkLight",themeFont:"lucida",timerRing:"harp",timerRingVolume:"100",alwaysShowIconMenu:!0,
twentyFourHourTime:!1,blinkingColon:!1},settings=cloneObj(defaultSettings),stopwatchData={total:0},timerData={from:6E5,total:6E5,isMuted:!1},audios={},audioTypes={timerRing:"timerEndHarp"},audiosCurrentlyPlaying=[],loadFlags=0,_="";function addPeriod(d){var f=document.getElementById("periods"+d),n=lastUsedPeriodIds[d-1]++,q=document.createElement("div");q.id="period"+d+"_"+n;q.setAttribute("data-id",n);q.classList.add("period");q.insertAdjacentHTML("beforeend",`<label for="periodName${d}_${n}">Name: </label>
<input type="text" oninput="recalcUnsavedChanges()" id="periodName${d}_${n}" title="${hints.schPeriodName}" value="Period ${f.childElementCount+1}"><br><br>
<label for="periodStart${d}_${n}">Starts: </label>
<input type="time" oninput="recalcUnsavedChanges()" id="periodStart${d}_${n}" title="${hints.schPeriodStart}">
<div class="floatRight">
	<label for="periodEnd${d}_${n}">Ends: </label>
	<input type="time" oninput="recalcUnsavedChanges()" id="periodEnd${d}_${n}" title="${hints.schPeriodEnd}">
</div><br><br>
<div class="topRightBtnMenu">
	<span class="material-symbols-outlined" onclick="movePeriodUp(${d},${n})" data-purpose="moveUp" title="${hints.periodMoveUp}">move_up</span>
	<span class="material-symbols-outlined textDanger" onclick="removePeriod(${d},${n})" data-purpose="remove" title="${hints.periodRemove}">delete</span>
	<span class="material-symbols-outlined" onclick="movePeriodDown(${d},${n})" data-purpose="moveDown" title="${hints.periodMoveDown}">move_down</span>
</div>`);f.appendChild(q);recalcUnsavedChanges();return n}function addScheduleBlock(){var d=document.createElement("div");d.classList.add("scheduleBlock");var f=lastUsedScheduleId++;lastUsedPeriodIds[f-1]=1;d.id="schedule"+f;d.setAttribute("data-id",f);d.insertAdjacentHTML("beforeend",`<div title="${hints.schName}">
	<label for="schNameInput${f}" class="schLabel">Schedule name</label>
	<input type="text" oninput="recalcUnsavedChanges()" id="schNameInput${f}" value="Schedule ${f}">
</div>
<div title="${hints.schPeriods}">
	<label class="schLabel">Periods</label>
	<div class="periodsBlock" id="periods${f}"></div>
	<button class="addPeriod" id="addPeriod${f}" onclick="addPeriod(${f})">ADD PERIOD</button>
</div>
<div id="days${f}" title="${hints.schDays}">
	<label class="schLabel">Days of the week</label>
	<input type="checkbox" oninput="recalcUnsavedChanges()" id="sunday${f}"><label for="sunday${f}"> Sunday</label><br>
	<input type="checkbox" oninput="recalcUnsavedChanges()" id="monday${f}"><label for="monday${f}"> Monday</label><br>
	<input type="checkbox" oninput="recalcUnsavedChanges()" id="tuesday${f}"><label for="tuesday${f}"> Tuesday</label><br>
	<input type="checkbox" oninput="recalcUnsavedChanges()" id="wednesday${f}"><label for="wednesday${f}"> Wednesday</label><br>
	<input type="checkbox" oninput="recalcUnsavedChanges()" id="thursday${f}"><label for="thursday${f}"> Thursday</label><br>
	<input type="checkbox" oninput="recalcUnsavedChanges()" id="friday${f}"><label for="friday${f}"> Friday</label><br>
	<input type="checkbox" oninput="recalcUnsavedChanges()" id="saturday${f}"><label for="saturday${f}"> Saturday</label><br>
</div>
<div class="buttonContainer">
<button class="btnInfo" onclick="moveScheduleUp(${f})" data-purpose="moveUp">Move up</button>
<button class="btnDanger" onclick="removeSchedule(${f})" data-purpose="remove">Remove</button>
	<button class="btnInfo" onclick="moveScheduleDown(${f})" data-purpose="moveDown">Move down</button>
</div>`);scheduleContainer.appendChild(d);recalcUnsavedChanges();return f}function moveScheduleDown(d){d=document.getElementById("schedule"+d);var f=d.nextElementSibling;f&&f.insertAdjacentElement("afterend",d);recalcUnsavedChanges()}function moveScheduleUp(d){d=document.getElementById("schedule"+d);var f=d.previousElementSibling;f&&f.insertAdjacentElement("beforebegin",d);recalcUnsavedChanges()}function removePeriod(d,f){document.getElementById("period"+d+"_"+f).remove();recalcUnsavedChanges()}
function movePeriodDown(d,f){d=document.getElementById("period"+d+"_"+f);(f=d.nextElementSibling)&&f.insertAdjacentElement("afterend",d);recalcUnsavedChanges()}function movePeriodUp(d,f){d=document.getElementById("period"+d+"_"+f);(f=d.previousElementSibling)&&f.insertAdjacentElement("beforebegin",d);recalcUnsavedChanges()}function removeSchedule(d){document.getElementById("schedule"+d).remove();recalcUnsavedChanges()}
function currentSchedulesToJSON(){var d=[];scheduleContainer.querySelectorAll(".scheduleBlock").forEach(function(f){var n={name:"<unset>",periods:[],days:0},q=parseInt(f.getAttribute("data-id"));n.name=document.getElementById("schNameInput"+q).value;var w=0;document.getElementById("days"+q).querySelectorAll("input").forEach(function(r){var z=r.id.replace(q,"");r.checked&&(w|=daysBitmap[z])});n.days=w;f.querySelectorAll(".period").forEach(function(r){var z={name:"<unset>",starts:"",ends:""};r=parseInt(r.getAttribute("data-id"));
r=q+"_"+r;z.name=document.getElementById("periodName"+r).value;z.starts=document.getElementById("periodStart"+r).value;z.ends=document.getElementById("periodEnd"+r).value;n.periods.push(z)});d.push(n)});return d}
function setCurrentSchedules(d){try{return scheduleContainer.innerHTML="",d.forEach(function(f){var n=addScheduleBlock();document.getElementById("schNameInput"+n).value=f.name;Object.keys(daysBitmap).forEach(function(q){f.days&daysBitmap[q]&&(document.getElementById(q+n).checked=!0)});f.periods.forEach(function(q){var w=addPeriod(n);w=n+"_"+w;document.getElementById("periodName"+w).value=q.name;document.getElementById("periodStart"+w).value=q.starts;document.getElementById("periodEnd"+w).value=q.ends})}),
!0}catch(f){return console.error(f),!1}}function recalcUnsavedChanges(){if(null===lastSavedSchedules)return!1;var d=currentSchedulesToJSON();document.body.classList.toggle("schedulesExist",!!d.length);if(usingURL)return!1;d=JSON.stringify(d)!==JSON.stringify(lastSavedSchedules);unsavedChanges.className=d?"":"hidden";return d}function saveState(){setUsingURL(!1);lastSavedSchedules=currentSchedulesToJSON();localforage.setItem("savedSchedules",lastSavedSchedules);unsavedChanges.className=""}
function setUsingURL(d){usingURL=d;usingURLNotifier.classList.toggle("hidden",!d)}setUsingURL(!1);function timeBitToDate(d){var f=new Date,n=d.split(":");d=parseInt(n[0]);n=parseInt(n[1]);f.setHours(d);f.setMinutes(n);f.setSeconds(0);f.setMilliseconds(0);return f}
function serializeSchedules(){return lastSavedSchedules.map(function(d){var f=[];f.push(userTextToBase64(d.name));f.push(d.days.toString(16));for(let n=0;n<d.periods.length;n++){let q=d.periods[n];f.push(compressTimeBit(q.starts)+compressTimeBit(q.ends)+userTextToBase64(q.name))}return f.join(",")}).join(";")}
function deserializeSchCode(d){return d.split(";").map(function(f){f=f.split(",");return{name:base64ToUserText(f[0]),periods:f.slice(2).map(function(n){return{name:base64ToUserText(n.slice(4)),starts:decompressTimeBit(n.slice(0,2)),ends:decompressTimeBit(n.slice(2,4))}}),days:parseInt(f[1],16)}})}function compressTimeBit(d){var f=d.split(":");d=parseInt(f[0]);f=parseInt(f[1]);return timeToCharacter[d]+timeToCharacter[f]}
function decompressTimeBit(d){var f=timeToCharacter.findIndex(function(q){return q===d[0]}),n=timeToCharacter.findIndex(function(q){return q===d[1]});return pad0(f)+":"+pad0(n)}function userTextToBase64(d){return btoa(Array.from((new TextEncoder).encode(d),function(f){return String.fromCodePoint(f)}).join("")).replaceAll("/","-")}function base64ToUserText(d){return(new TextDecoder).decode(Uint8Array.from(atob(d.replaceAll("-","/")),function(f){return f.codePointAt(0)}))}
function applySettings(d){var f=addObj(defaultSettings,d);settings=cloneObj(f);Object.keys(f).forEach(function(n){var q=document.querySelector(`[data-setting-name="${n}"]`);q?"checkbox"!==q.type?q.value=f[n]:q.checked=f[n]:console.warn(`Could not apply setting ${JSON.stringify(n)} (no setting element).`)});reprocessSettings()}
function reprocessSettings(){"themeBg"in settings&&(document.documentElement.setAttribute("data-theme-bg",settings.themeBg),document.documentElement.classList.toggle("darkishBg",darkishBgs.includes(settings.themeBg)),document.documentElement.classList.toggle("lightishBg",lightishBgs.includes(settings.themeBg)));"themeFg"in settings&&document.documentElement.setAttribute("data-theme-fg",settings.themeFg);"themeFont"in settings&&document.documentElement.setAttribute("data-theme-font",settings.themeFont);
"timerRing"in settings&&(audiosCurrentlyPlaying.includes("timerRing")&&audioTypes.timerRing!==settings.timerRing&&audioSwitch("timerRing",settings.timerRing),audioTypes.timerRing=settings.timerRing);"timerRingVolume"in settings&&setAudioVolume("timerRing",parseInt(settings.timerRingVolume)/100);"alwaysShowIconMenu"in settings&&iconMenu.classList.toggle("hoverToShow",!settings.alwaysShowIconMenu)}
function updateSettings(){var d={};document.querySelectorAll("[data-setting-name]").forEach(function(f){var n="checkbox"===f.type;d[f.getAttribute("data-setting-name")]=n?f.checked:f.value});settings=addObj(defaultSettings,cloneObj(d));localforage.setItem("settings",settings);reprocessSettings()}
function makeDraggable(d,f){function n(x){x.preventDefault();q=r-x.clientX;w=z-x.clientY;r=x.clientX;z=x.clientY;d.style.top=d.offsetTop-w+"px";d.style.left=d.offsetLeft-q+"px"}var q=0,w=0,r=0,z=0;f.addEventListener("mousedown",function(x){x.preventDefault();document.body.classList.add("dragging");r=x.clientX;z=x.clientY;document.onmouseup=function(){document.body.classList.remove("dragging");document.onmouseup=null;document.onmousemove=null};document.onmousemove=n})}
function adjustFontSize(d){const f=d.parentElement.getBoundingClientRect();d.style.fontSize=.225*Math.min(f.width,f.height)+"px"}function timeDiffToMs(d){var f=[1E3,6E4,36E5,864E5];return d.replace(/[^\d:.]/g,"").split(":").reverse().map(function(n,q){q&&(n=n.replaceAll(".",""));q=n.indexOf(".");-1!==q&&(n=n.slice(0,q)+"."+n.slice(q).replaceAll(".",""));return parseFloat(n||"0")||0}).reduce(function(n,q,w){return n+q*(f[w]||0)},0)}
function getCurrentPeriod(){if(null===lastSavedSchedules)return null;var d=new Date,f=1<<d.getDay();for(let n=0;n<lastSavedSchedules.length;n++){let q=lastSavedSchedules[n];if(!(q.days&f))break;for(let w=0;w<q.periods.length;w++){let r=q.periods[w],z=timeBitToDate(r.starts),x=timeBitToDate(r.ends);if(z<=d&&d<=x)return{name:r.name,starts:z,ends:x}}}return null}
function msToTimeDiff(d,f,n){f=(f?f:Math.round)(d/1E3);d=[];var q=!1;if(q||3600<=f)d.push(Math.floor(f/3600).toString()),f%=3600,q=!0;if(q||60<=f)d.push(Math.floor(f/60).toString()),f%=60;d.push(n?f.toFixed(n):f.toString());2<d.length&&(d[1]=d[1].padStart(2,"0"));return 1<d.length?(f=d.length-1,d[f]=d[f].padStart(n?3+n:2,"0"),d.join(":")):d[0]+(n?"":"s")}function pad0(d){return d.toString().padStart(2,"0")}
function cloneObj(d){if(null==d||"object"!=typeof d)return d;var f=new d.constructor,n;for(n in d)d.hasOwnProperty(n)&&(f[n]=cloneObj(d[n]));return f}function addObj(d,f){d=cloneObj(d);if("object"!==typeof f)return d;for(var n in f)f.hasOwnProperty(n)&&(d[n]=f[n]);return d}
function loadAudios(){var d={silent:{slug:"silent.mp3",loop:!0},timerEndHarp:{slug:"timer-end-harp.mp3",loop:!0},timerEndQuick:{slug:"timer-end-quick.mp3",loop:!0}};Object.keys(d).forEach(function(f){var n=d[f],q=new Audio("./audio/"+n.slug);"loop"in n&&(q.loop=n.loop);audios[f]=q})}loadAudios();function audioPlay(d){let f=audioTypes[d];f&&(audios[f].play(),audiosCurrentlyPlaying.push(d))}function setAudioVolume(d,f){if(d=audioTypes[d])audios[d].volume=f}
function audioSwitch(d,f){var n=audioTypes[d];n&&(n=audios[n].volume,audioStopReset(d),setAudioVolume(d,1),audioTypes[d]=f,audioPlay(d),setAudioVolume(d,n))}function audioStopReset(d){let f=audioTypes[d];f&&(audios[f].pause(),audios[f].currentTime=0,audiosCurrentlyPlaying.splice(audiosCurrentlyPlaying.indexOf(d),1))}function loaded(){var d=3;navigator.onLine||(d=1);loadFlags++;loadFlags>=d&&(loadingScreen.className="exitDown",document.body.classList.remove("stillLoading"))};function tick(){var d=new Date,f=settings.twentyFourHourTime?d.getHours().toString().padStart(2,"0"):d.getHours()%12||12,n=settings.blinkingColon?'<span class="textInvisible">:</span>':":";0===d.getSeconds()%2&&(n=":");var q=d.getMinutes().toString().padStart(2,"0");timeView.innerHTML=f+n+q;(f=getCurrentPeriod())?(timePeriod.textContent=f.name,timeOver.textContent=msToTimeDiff(d-f.starts,Math.ceil)+" over",timeLeft.textContent=msToTimeDiff(f.ends-d,Math.floor)+" left"):(timePeriod.textContent="",
timeOver.textContent="",timeLeft.textContent="");stopwatchData.running&&(d=stopwatchData.total+(performance.now()-stopwatchData.startTime),d=msToTimeDiff(Math.floor(d),function(w){return parseFloat(w.toFixed(2))},2),stopwatchTime.textContent=d);if(timerData.running){d=timerData.total-(performance.now()-timerData.startTime);0>=d&&(d=0,timerData.running=!1,timerData.total=0,timerTime.disabled=!1,timerBtnPlay.classList.toggle("hidden",!0),timerBtnPause.classList.toggle("hidden",!0),timerBtnRestart.classList.toggle("hidden",
!1),timerData.isMuted||audioPlay("timerRing"));d=Math.floor(d);let w=0;1E4>=d&&(w=1);5E3>d&&(w=2);0===d&&(w=0);d=msToTimeDiff(Math.floor(d),function(r){return w?parseFloat(r.toFixed(w)):Math.ceil(r)},w).replace("s","");timerTime.value=d}document.getElementById("youAreOffline").classList.toggle("hidden",navigator.onLine);requestAnimationFrame(tick)}
window.addEventListener("mousemove",function(d){d=(d.clientX/window.innerWidth*100).toFixed();document.body.dataset.pointerpos=25>d?"left":75<d?"right":"center"});var showModes=["showMain","showSchedule","showSettings"];function setShow(d){for(var f in showModes)document.body.classList.remove(showModes[f]);document.body.classList.add(d)}scheduleBtn.addEventListener("click",function(){setShow("showSchedule");scheduleContainer.childElementCount||addScheduleBlock()});
editSchedulesIcon.addEventListener("click",function(){setShow("showSchedule");scheduleContainer.childElementCount||addScheduleBlock()});function exitScheduleViewAction(){recalcUnsavedChanges()?confirm("You have unsaved changes - exiting will delete them! Are you sure?")&&(setCurrentSchedules(lastSavedSchedules),recalcUnsavedChanges(),setShow("showMain")):setShow("showMain")}exitScheduleView.addEventListener("click",exitScheduleViewAction);
saveSchedule.addEventListener("click",function(){saveState();recalcUnsavedChanges();setShow("showMain")});deleteAll.addEventListener("click",function(){confirm("Are you sure you want to delete all schedules? This is irreversible!")&&(scheduleContainer.innerHTML="",saveState(),recalcUnsavedChanges(),setShow("showMain"))});addSchedule.addEventListener("click",function(){addScheduleBlock()});
localforage.getItem("savedSchedules").then(function(d){d?(setCurrentSchedules(d),lastSavedSchedules=d):lastSavedSchedules=[];(d=(new URL(location.href)).searchParams.get("sv1"))?(d=deserializeSchCode(d),JSON.stringify(lastSavedSchedules)!==JSON.stringify(d)&&(setUsingURL(!0),setCurrentSchedules(d),lastSavedSchedules=d)):setUsingURL(!1);recalcUnsavedChanges()});backToOwnSchedules.addEventListener("click",function(){var d=new URL(location.href);d.searchParams.delete("sv1");location.assign(d)});
uploadSchedules.addEventListener("click",function(){uploadFileInput.click()});uploadFileInput.addEventListener("change",function(d){if(d=d.target.files[0]){var f=new FileReader;f.readAsText(d,"utf-8");f.onload=function(n){try{var q=JSON.parse(n.target.result);setCurrentSchedules(q)||alert("The file you uploaded may be corrupted - there was an error in loading the schedules.")}catch(w){alert("The file you uploaded could not be parsed correctly. It may be corrupted, or it may just be the wrong file.")}}}});
shareSchedules.addEventListener("click",function(){shareMenu.classList.toggle("hidden")});
downloadSchedules.addEventListener("click",function(){if(recalcUnsavedChanges())alert("You have unsaved changes. Please save/discard first, then download your schedules.");else{var d=prompt("Give your schedules a title (hint: school name, regular schedules, etc.)");if(null!==d){d=d.trim()||"Schedules";var f=document.createElement("a");f.setAttribute("href","data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(lastSavedSchedules,null,"\t")));f.setAttribute("download",d+".json");
f.click()}}});
copySchedulesLink.addEventListener("click",function(){if(recalcUnsavedChanges())alert("You have unsaved changes. Please save/discard first, then download your schedules.");else{var d=serializeSchedules(),f=new URL(location.href);f.searchParams.set("sv1",d);navigator.clipboard.writeText(f.toString()).then(function(){alert("The link has been successfully copied! Share it with your classmates!\n"+f.toString())}).catch(function(n){alert("There was an error. Please copy the link manually:\n"+f.toString());
console.error(n)})}});localforage.getItem("settings").then(function(d){d&&applySettings(d);updateSettings()});settingsIcon.addEventListener("click",function(){setShow("showSettings")});closeSettingsIcon.addEventListener("click",function(){setShow("showMain")});closeSchedulesIcon.addEventListener("click",exitScheduleViewAction);document.querySelectorAll("[data-setting-name]").forEach(function(d){d.addEventListener("input",function(){updateSettings()})});
stopwatchIcon.addEventListener("click",function(){stopwatchIcon.classList.toggle("btnActive");stopwatch.classList.toggle("hidden")});stopwatchBtnPlay.addEventListener("click",function(){stopwatchData.startTime=performance.now();stopwatchData.running=!0;stopwatchBtnPlay.classList.toggle("hidden",!0);stopwatchBtnPause.classList.toggle("hidden",!1);stopwatchBtnRestart.classList.toggle("hidden",!1)});
stopwatchBtnPause.addEventListener("click",function(){stopwatchData.total+=performance.now()-stopwatchData.startTime;stopwatchData.running=!1;stopwatchBtnPause.classList.toggle("hidden",!0);stopwatchBtnPlay.classList.toggle("hidden",!1)});
stopwatchBtnRestart.addEventListener("click",function(){stopwatchData.total=0;stopwatchData.running=!1;stopwatchTime.textContent="0.00";stopwatchBtnPlay.classList.toggle("hidden",!1);stopwatchBtnPause.classList.toggle("hidden",!0);stopwatchBtnRestart.classList.toggle("hidden",!0)});var resizer=new ResizeObserver(function(d){d.forEach(function(f){f=f.target.id+"Time";window[f]&&adjustFontSize(window[f])})});resizer.observe(stopwatch);resizer.observe(timer);adjustFontSize(stopwatchTime);adjustFontSize(timerTime);
makeDraggable(stopwatch,stopwatchDrag);makeDraggable(timer,timerDrag);timerIcon.addEventListener("click",function(){timerIcon.classList.toggle("btnActive");timer.classList.toggle("hidden")});timerBtnPlay.addEventListener("click",function(){timerData.startTime=performance.now();timerData.running=!0;timerTime.disabled=!0;timerBtnPlay.classList.toggle("hidden",!0);timerBtnPause.classList.toggle("hidden",!1);timerBtnRestart.classList.toggle("hidden",!1)});
timerBtnPause.addEventListener("click",function(){timerData.total-=performance.now()-timerData.startTime;timerData.running=!1;timerTime.disabled=!1;timerBtnPause.classList.toggle("hidden",!0);timerBtnPlay.classList.toggle("hidden",!1)});
timerBtnRestart.addEventListener("click",function(){timerData.total=timerData.from;timerData.running=!1;timerTime.value=msToTimeDiff(timerData.from).replace("s","");timerTime.disabled=!1;audioStopReset("timerRing");timerBtnPlay.classList.toggle("hidden",!1);timerBtnPause.classList.toggle("hidden",!0);timerBtnRestart.classList.toggle("hidden",!0)});
timerTime.addEventListener("input",function(){timerData.running||(0===timerData.total&&(timerBtnPlay.classList.toggle("hidden",!1),timerBtnPause.classList.toggle("hidden",!0),timerBtnRestart.classList.toggle("hidden",!0),audioStopReset("timerRing")),timerData.from=timerData.total=timeDiffToMs(timerTime.value))});
timerMute.addEventListener("click",function(){var d=!timerData.isMuted;timerData.isMuted=d;timerMute.textContent=d?"volume_off":"volume_up";timerMute.title=d?"Click to unmute the timer":"Click to mute the timer";d&&audioStopReset("timerRing")});requestAnimationFrame(tick);window.addEventListener("load",function(){loaded()});"serviceWorker"in navigator&&navigator.serviceWorker.register("./sw.js");
